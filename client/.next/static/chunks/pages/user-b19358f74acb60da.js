(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[235],{7505:function(e,n,t){(window.__NEXT_P=window.__NEXT_P||[]).push(["/user",function(){return t(8962)}])},5789:function(e,n,t){"use strict";var r=t(5893),a=(t(9008),t(1664)),s=t(1163),i=t(5085),c=t(4865),l=t.n(c);t(4629);s.default.onRouteChangeStart=function(e){return l().start()},s.default.onRouteChangeComplete=function(e){return l().done()},s.default.onRouteChangeError=function(e){return l().done()};n.Z=function(e){var n=e.children;return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("link",{rel:"stylesheet",href:"https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/css/bootstrap.min.css",integrity:"sha384-Gn5384xqQ1aoWXA+058RXPxPg6fy4IWvTNh0E263XmFcJlSAwiGgFAW/dAiS6JXm",crossOrigin:"anonymous"}),(0,r.jsx)("link",{rel:"stylesheet",href:"/static/css/styles.css"})]})," ",(0,r.jsxs)("ul",{className:"nav nav-tabs bg-warning",children:[(0,r.jsx)("li",{className:"nav-item",children:(0,r.jsx)(a.default,{href:"/",children:(0,r.jsx)("a",{className:"nav-link text-dark",children:"Home"})})}),(0,r.jsx)("li",{className:"nav-item",children:(0,r.jsx)(a.default,{href:"/user/link/create",children:(0,r.jsx)("a",{className:"nav-link text-dark btn btn-success",style:{borderRadius:"0px"},children:"Submit a link"})})}),!(0,i.$D)()&&(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("li",{className:"nav-item",children:(0,r.jsx)(a.default,{href:"/login",children:(0,r.jsx)("a",{className:"nav-link text-dark",children:"Login"})})}),(0,r.jsx)("li",{className:"nav-item",children:(0,r.jsx)(a.default,{href:"/register",children:(0,r.jsx)("a",{className:"nav-link text-dark",children:"Register"})})})]}),(0,i.$D)()&&"admin"===(0,i.$D)().role&&(0,r.jsx)("li",{className:"nav-item ml-auto",children:(0,r.jsx)(a.default,{href:"/admin",children:(0,r.jsx)("a",{className:"nav-link text-dark",children:(0,i.$D)().name})})}),(0,i.$D)()&&"subscriber"===(0,i.$D)().role&&(0,r.jsx)("li",{className:"nav-item ml-auto",children:(0,r.jsx)(a.default,{href:"/user",children:(0,r.jsx)("a",{className:"nav-link text-dark",children:(0,i.$D)().name})})}),(0,i.$D)()&&(0,r.jsx)("li",{className:"nav-item",children:(0,r.jsx)("a",{onClick:i.kS,className:"nav-link text-dark",children:"Logout"})})]})," ",(0,r.jsx)("div",{className:"container pt-5 pb-5",children:n})]})}},1838:function(e,n,t){"use strict";t.d(n,{bl:function(){return a},iC:function(){return s}});var r=(0,t(1752).default)().publicRuntimeConfig,a=r.API,s=r.APP_NAME;r.DOMAIN,r.PRODUCTION,r.FB_APP_ID},5085:function(e,n,t){"use strict";t.d(n,{ej:function(){return s},YR:function(){return c},$D:function(){return l},kS:function(){return o},Nq:function(){return u}});var r=t(1955),a=t(1163),s=function(e,n){return i(e)},i=function(e){return r.Z.get(e)},c=function(e,n){var t,a;t="token",a=e.data.token,r.Z.set(t,a,{expires:1}),function(e,n){localStorage.setItem(e,JSON.stringify(n))}("user",e.data.user),n()},l=function(){if(s("token"))return!!localStorage.getItem("user")&&JSON.parse(localStorage.getItem("user"))},o=function(){var e;e="token",r.Z.remove(e),function(e){localStorage.removeItem(e)}("user"),a.default.push("/login")},u=function(e,n){if(localStorage.getItem("user")){var t=JSON.parse(localStorage.getItem("user"));t=e,localStorage.setItem("user",JSON.stringify(t)),n()}}},8962:function(e,n,t){"use strict";t.r(n);var r=t(4051),a=t.n(r),s=t(5893),i=t(5789),c=t(1664),l=t(1163),o=t(9669),u=t.n(o),d=t(381),f=t.n(d),h=t(1838),m=(t(5085),t(4376));function x(e,n,t,r,a,s,i){try{var c=e[s](i),l=c.value}catch(o){return void t(o)}c.done?n(l):Promise.resolve(l).then(r,a)}n.default=(0,m.default)((function(e){var n=e.user,t=e.userLinks,r=e.token,o=function(){var e,n=(e=a().mark((function e(n){var t;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return console.log("delete link > ",n),e.prev=1,e.next=4,u().delete("".concat(h.bl,"/link/").concat(n),{headers:{Authorization:"Bearer ".concat(r)}});case 4:t=e.sent,console.log("LINK DELETE SUCCESS ",t),l.default.replace("/user"),e.next=12;break;case 9:e.prev=9,e.t0=e.catch(1),console.log("LINK DELETE ",e.t0);case 12:case"end":return e.stop()}}),e,null,[[1,9]])})),function(){var n=this,t=arguments;return new Promise((function(r,a){var s=e.apply(n,t);function i(e){x(s,r,a,i,c,"next",e)}function c(e){x(s,r,a,i,c,"throw",e)}i(void 0)}))});return function(e){return n.apply(this,arguments)}}();return(0,s.jsxs)(i.Z,{children:[(0,s.jsxs)("h1",{children:[n.name,"'s dashboard ",(0,s.jsxs)("span",{className:"text-danger",children:["/",n.role]})]}),(0,s.jsx)("hr",{}),(0,s.jsxs)("div",{className:"row",children:[(0,s.jsx)("div",{className:"col-md-4",children:(0,s.jsxs)("ul",{className:"nav flex-column",children:[(0,s.jsx)("li",{className:"nav-item",children:(0,s.jsx)(c.default,{href:"/user/link/create",children:(0,s.jsx)("a",{className:"nav link",children:"Submit a link"})})}),(0,s.jsx)("li",{className:"nav-item",children:(0,s.jsx)(c.default,{href:"/user/profile/update",children:(0,s.jsx)("a",{className:"nav link",children:"Update profile"})})})]})}),(0,s.jsxs)("div",{className:"col-md-8",children:[(0,s.jsx)("h2",{children:"Your links"}),(0,s.jsx)("br",{}),t.map((function(e,n){return(0,s.jsxs)("div",{className:"row alert alert-primary p-2",children:[(0,s.jsx)("div",{className:"col-md-8",children:(0,s.jsxs)("a",{href:e.url,target:"_blank",children:[(0,s.jsx)("h5",{className:"pt-2",children:e.title}),(0,s.jsx)("h6",{className:"pt-2 text-danger",style:{fontSize:"12px"},children:e.url})]})}),(0,s.jsx)("div",{className:"col-md-4 pt-2",children:(0,s.jsxs)("span",{className:"pull-right",children:[f()(e.createdAt).fromNow()," by ",e.postedBy.name]})}),(0,s.jsxs)("div",{className:"col-md-12",children:[(0,s.jsxs)("span",{className:"badge text-dark",children:[e.type," / ",e.medium]}),e.categories.map((function(e,n){return(0,s.jsx)("span",{className:"badge text-success",children:e.name},n)})),(0,s.jsxs)("span",{className:"badge text-secondary",children:[e.clicks," clicks"]}),(0,s.jsx)(c.default,{href:"/user/link/".concat(e._id),children:(0,s.jsx)("span",{className:"badge text-warning pull-right",children:"Update"})}),(0,s.jsx)("span",{onClick:function(n){return function(e,n){e.preventDefault(),window.confirm("Are you sure you want to delete?")&&o(n)}(n,e._id)},className:"badge text-danger pull-right",children:"Delete"})]})]},n)}))]})]})]})}))},4376:function(e,n,t){"use strict";t.r(n);var r=t(4051),a=t.n(r),s=t(5893),i=t(9669),c=t.n(i),l=t(1838),o=t(5085);function u(e,n,t,r,a,s,i){try{var c=e[s](i),l=c.value}catch(o){return void t(o)}c.done?n(l):Promise.resolve(l).then(r,a)}function d(e,n,t){return n in e?Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[n]=t,e}function f(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{},r=Object.keys(t);"function"===typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(t).filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})))),r.forEach((function(n){d(e,n,t[n])}))}return e}n.default=function(e){var n=function(n){return(0,s.jsx)(e,f({},n))};return n.getInitialProps=function(){var n,t=(n=a().mark((function n(t){var r,s,i,u;return a().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(r=(0,o.ej)("token",t.req),s=null,i=[],!r){n.next=16;break}return n.prev=4,n.next=7,c().get("".concat(l.bl,"/user"),{headers:{authorization:"Bearer ".concat(r),contentType:"application/json"}});case 7:u=n.sent,console.log("response in withUser",u),s=u.data.user,i=u.data.links,n.next=16;break;case 13:n.prev=13,n.t0=n.catch(4),401===n.t0.response.status&&(s=null);case 16:if(null!==s){n.next=20;break}t.res.writeHead(302,{Location:"/"}),t.res.end(),n.next=32;break;case 20:if(n.t1=f,n.t2={},!e.getInitialProps){n.next=28;break}return n.next=25,e.getInitialProps(t);case 25:n.t3=n.sent,n.next=29;break;case 28:n.t3={};case 29:return n.t4=n.t3,n.t5={user:s,token:r,userLinks:i},n.abrupt("return",(0,n.t1)(n.t2,n.t4,n.t5));case 32:case"end":return n.stop()}}),n,null,[[4,13]])})),function(){var e=this,t=arguments;return new Promise((function(r,a){var s=n.apply(e,t);function i(e){u(s,r,a,i,c,"next",e)}function c(e){u(s,r,a,i,c,"throw",e)}i(void 0)}))});return function(e){return t.apply(this,arguments)}}(),n}}},function(e){e.O(0,[774,885,61,304,888,179],(function(){return n=7505,e(e.s=n);var n}));var n=e.O();_N_E=n}]);