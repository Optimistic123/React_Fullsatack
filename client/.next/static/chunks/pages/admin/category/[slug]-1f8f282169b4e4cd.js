(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[780],{4278:function(e,t,n){(window.__NEXT_P=window.__NEXT_P||[]).push(["/admin/category/[slug]",function(){return n(1772)}])},5789:function(e,t,n){"use strict";var r=n(5893),a=(n(9008),n(1664)),s=n(1163),c=n(5085),i=n(4865),o=n.n(i);n(4629);s.default.onRouteChangeStart=function(e){return o().start()},s.default.onRouteChangeComplete=function(e){return o().done()},s.default.onRouteChangeError=function(e){return o().done()};t.Z=function(e){var t=e.children;return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("link",{rel:"stylesheet",href:"https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/css/bootstrap.min.css",integrity:"sha384-Gn5384xqQ1aoWXA+058RXPxPg6fy4IWvTNh0E263XmFcJlSAwiGgFAW/dAiS6JXm",crossOrigin:"anonymous"}),(0,r.jsx)("link",{rel:"stylesheet",href:"/static/css/styles.css"})]})," ",(0,r.jsxs)("ul",{className:"nav nav-tabs bg-warning",children:[(0,r.jsx)("li",{className:"nav-item",children:(0,r.jsx)(a.default,{href:"/",children:(0,r.jsx)("a",{className:"nav-link text-dark",children:"Home"})})}),(0,r.jsx)("li",{className:"nav-item",children:(0,r.jsx)(a.default,{href:"/user/link/create",children:(0,r.jsx)("a",{className:"nav-link text-dark btn btn-success",style:{borderRadius:"0px"},children:"Submit a link"})})}),!(0,c.$D)()&&(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("li",{className:"nav-item",children:(0,r.jsx)(a.default,{href:"/login",children:(0,r.jsx)("a",{className:"nav-link text-dark",children:"Login"})})}),(0,r.jsx)("li",{className:"nav-item",children:(0,r.jsx)(a.default,{href:"/register",children:(0,r.jsx)("a",{className:"nav-link text-dark",children:"Register"})})})]}),(0,c.$D)()&&"admin"===(0,c.$D)().role&&(0,r.jsx)("li",{className:"nav-item ml-auto",children:(0,r.jsx)(a.default,{href:"/admin",children:(0,r.jsx)("a",{className:"nav-link text-dark",children:(0,c.$D)().name})})}),(0,c.$D)()&&"subscriber"===(0,c.$D)().role&&(0,r.jsx)("li",{className:"nav-item ml-auto",children:(0,r.jsx)(a.default,{href:"/user",children:(0,r.jsx)("a",{className:"nav-link text-dark",children:(0,c.$D)().name})})}),(0,c.$D)()&&(0,r.jsx)("li",{className:"nav-item",children:(0,r.jsx)("a",{onClick:c.kS,className:"nav-link text-dark",children:"Logout"})})]})," ",(0,r.jsx)("div",{className:"container pt-5 pb-5",children:t})]})}},1838:function(e,t,n){"use strict";n.d(t,{bl:function(){return a},iC:function(){return s}});var r=(0,n(1752).default)().publicRuntimeConfig,a=r.API,s=r.APP_NAME;r.DOMAIN,r.PRODUCTION,r.FB_APP_ID},2933:function(e,t,n){"use strict";n.d(t,{r:function(){return a},U:function(){return s}});var r=n(5893),a=function(e){return(0,r.jsx)("div",{className:"alert alert-success",children:e})},s=function(e){return(0,r.jsx)("div",{className:"alert alert-danger",children:e})}},5085:function(e,t,n){"use strict";n.d(t,{ej:function(){return s},YR:function(){return i},$D:function(){return o},kS:function(){return u},Nq:function(){return l}});var r=n(1955),a=n(1163),s=function(e,t){return c(e)},c=function(e){return r.Z.get(e)},i=function(e,t){var n,a;n="token",a=e.data.token,r.Z.set(n,a,{expires:1}),function(e,t){localStorage.setItem(e,JSON.stringify(t))}("user",e.data.user),t()},o=function(){if(s("token"))return!!localStorage.getItem("user")&&JSON.parse(localStorage.getItem("user"))},u=function(){var e;e="token",r.Z.remove(e),function(e){localStorage.removeItem(e)}("user"),a.default.push("/login")},l=function(e,t){if(localStorage.getItem("user")){var n=JSON.parse(localStorage.getItem("user"));n=e,localStorage.setItem("user",JSON.stringify(n)),t()}}},1772:function(e,t,n){"use strict";n.r(t);var r=n(4051),a=n.n(r),s=n(5893),c=n(5152),i=n(7294),o=n(9669),u=n.n(o),l=n(6770),f=n.n(l),d=n(1838),m=n(2933),h=n(5789),g=n(6398);n(9624);function v(e,t,n,r,a,s,c){try{var i=e[s](c),o=i.value}catch(u){return void n(u)}i.done?t(o):Promise.resolve(o).then(r,a)}function x(e){return function(){var t=this,n=arguments;return new Promise((function(r,a){var s=e.apply(t,n);function c(e){v(s,r,a,c,i,"next",e)}function i(e){v(s,r,a,c,i,"throw",e)}c(void 0)}))}}function p(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function b(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"===typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter((function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable})))),r.forEach((function(t){p(e,t,n[t])}))}return e}var j=(0,c.default)((function(){return Promise.all([n.e(774),n.e(937),n.e(876),n.e(167)]).then(n.t.bind(n,1167,23))}),{loadableGenerated:{webpack:function(){return[1167]}},ssr:!1}),k=function(e){var t=e.oldCategory,n=e.token,r=(0,i.useState)({name:t.name,error:"",success:"",buttonText:"Update",imagePreview:t.image.url,image:""}),c=r[0],o=r[1],l=(0,i.useState)(t.content),g=l[0],v=l[1],k=(0,i.useState)("Update image"),N=k[0],y=k[1],w=c.name,P=c.success,O=c.error,S=c.image,C=c.buttonText,E=c.imagePreview,R=function(e){console.log(e),v(e),o(b({},c,{success:"",error:""}))},D=function(e){var t=!1;e.target.files[0]&&(t=!0),y(e.target.files[0].name),t&&f().imageFileResizer(e.target.files[0],300,300,"JPEG",100,0,(function(e){o(b({},c,{image:e,success:"",error:""}))}),"base64")},I=function(){var e=x(a().mark((function e(r){var s;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r.preventDefault(),o(b({},c,{buttonText:"Updating"})),console.table({name:w,content:g,image:S}),e.prev=3,e.next=6,u().put("".concat(d.bl,"/category/").concat(t.slug),{name:w,content:g,image:S},{headers:{Authorization:"Bearer ".concat(n)}});case 6:s=e.sent,console.log("CATEGORY UPDATE RESPONSE",s),o(b({},c,{imagePreview:s.data.image.url,success:"".concat(s.data.name," is updated")})),v(s.data.content),e.next=16;break;case 12:e.prev=12,e.t0=e.catch(3),console.log("CATEGORY CREATE ERROR",e.t0),o(b({},c,{buttonText:"Create",error:e.t0.response.data.error}));case 16:case"end":return e.stop()}}),e,null,[[3,12]])})));return function(t){return e.apply(this,arguments)}}();return(0,s.jsx)(h.Z,{children:(0,s.jsx)("div",{className:"row",children:(0,s.jsxs)("div",{className:"col-md-6 offset-md-3",children:[(0,s.jsx)("h1",{children:"Update category"}),(0,s.jsx)("br",{}),P&&(0,m.r)(P),O&&(0,m.U)(O),function(){return(0,s.jsxs)("form",{onSubmit:I,children:[(0,s.jsxs)("div",{className:"form-group",children:[(0,s.jsx)("label",{className:"text-muted",children:"Name"}),(0,s.jsx)("input",{onChange:(e="name",function(t){var n;o(b({},c,(p(n={},e,t.target.value),p(n,"error",""),p(n,"success",""),n)))}),value:w,type:"text",className:"form-control",required:!0})]}),(0,s.jsxs)("div",{className:"form-group",children:[(0,s.jsx)("label",{className:"text-muted",children:"Content"}),(0,s.jsx)(j,{value:g,onChange:R,placeholder:"Write something...",theme:"bubble",className:"pb-5 mb-3",style:{border:"1px solid #666"}})]}),(0,s.jsx)("div",{className:"form-group",children:(0,s.jsxs)("label",{className:"btn btn-outline-secondary",children:[N," ",(0,s.jsx)("span",{children:(0,s.jsx)("img",{src:E,alt:"image",height:"20"})}),(0,s.jsx)("input",{onChange:D,type:"file",accept:"image/*",className:"form-control",hidden:!0})]})}),(0,s.jsx)("div",{children:(0,s.jsx)("button",{className:"btn btn-outline-warning",children:C})})]});var e}()]})})})};k.getInitialProps=function(){var e=x(a().mark((function e(t){var n,r,s;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.req,n=t.query,r=t.token,e.next=3,u().post("".concat(d.bl,"/category/").concat(n.slug));case 3:return s=e.sent,e.abrupt("return",{oldCategory:s.data.category,token:r});case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),t.default=(0,g.default)(k)},6398:function(e,t,n){"use strict";n.r(t);var r=n(4051),a=n.n(r),s=n(5893),c=n(9669),i=n.n(c),o=n(1838),u=n(5085);function l(e,t,n,r,a,s,c){try{var i=e[s](c),o=i.value}catch(u){return void n(u)}i.done?t(o):Promise.resolve(o).then(r,a)}function f(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function d(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"===typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter((function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable})))),r.forEach((function(t){f(e,t,n[t])}))}return e}t.default=function(e){var t=function(t){return(0,s.jsx)(e,d({},t))};return t.getInitialProps=function(){var t,n=(t=a().mark((function t(n){var r,s,c,l;return a().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(r=(0,u.ej)("token",n.req),s=null,c=[],!r){t.next=15;break}return t.prev=4,t.next=7,i().get("".concat(o.bl,"/admin"),{headers:{authorization:"Bearer ".concat(r),contentType:"application/json"}});case 7:l=t.sent,s=l.data.user,c=l.data.links,t.next=15;break;case 12:t.prev=12,t.t0=t.catch(4),401===t.t0.response.status&&(s=null);case 15:if(null!==s){t.next=19;break}n.res.writeHead(302,{Location:"/"}),n.res.end(),t.next=31;break;case 19:if(t.t1=d,t.t2={},!e.getInitialProps){t.next=27;break}return t.next=24,e.getInitialProps(n);case 24:t.t3=t.sent,t.next=28;break;case 27:t.t3={};case 28:return t.t4=t.t3,t.t5={user:s,token:r,userLinks:c},t.abrupt("return",(0,t.t1)(t.t2,t.t4,t.t5));case 31:case"end":return t.stop()}}),t,null,[[4,12]])})),function(){var e=this,n=arguments;return new Promise((function(r,a){var s=t.apply(e,n);function c(e){l(s,r,a,c,i,"next",e)}function i(e){l(s,r,a,c,i,"throw",e)}c(void 0)}))});return function(e){return n.apply(this,arguments)}}(),t}}},function(e){e.O(0,[774,61,304,641,888,179],(function(){return t=4278,e(e.s=t);var t}));var t=e.O();_N_E=t}]);